# Step 0. a
library(usethis)
library(devtools)
library(roxygen2) # documentation
library(testthat) # testing
use_r("hello.R")
use_r("zzz.R")    # rename the package
use_package("Rcpp",type="LinkingTo")
# Step 0. c
use_rcpp()
devtools::document()
use_r("hello.R")
use_r("zzz.R")    # rename the package
use_package("Rcpp",type="LinkingTo")
devtools::document()
devtools::document()
Rcpp::compileAttributes()
devtools::load_all()
x <- rnorm(100, mean = 0)
y <- rnorm(100, mean = 1)
res1 <- pairwise_ks_test(list(X = x, Y = y))
res1
set.seed(100)
set.seed(100)
x <- rnorm(100, mean = 0)
y <- rnorm(100, mean = 1)
res1 <- pairwise_ks_test(list(X = x, Y = y))
res1
ks.test(x,y)
devtools::document()
Rcpp::compileAttributes()
devtools::load_all()
set.seed(100)
x <- rnorm(100, mean = 0)
y <- rnorm(100, mean = 1)
res1 <- pairwise_ks_test(list(X = x, Y = y))
set.seed(100)
x <- rnorm(50, mean = 0)
y <- rnorm(50, mean = 1)
res1 <- pairwise_ks_test(list(X = x, Y = y))
devtools::document()
Rcpp::compileAttributes()
devtools::load_all()
set.seed(100)
x <- rnorm(50, mean = 0)
y <- rnorm(50, mean = 1)
res1 <- pairwise_ks_test(list(X = x, Y = y))
res1
devtools::document()
Rcpp::compileAttributes()
devtools::document()
Rcpp::compileAttributes()
devtools::load_all()
set.seed(100)
x <- rnorm(50, mean = 0)
y <- rnorm(50, mean = 1)
res1 <- pairwise_ks_test(list(X = x, Y = y))
devtools::document()
Rcpp::compileAttributes()
devtools::load_all()
set.seed(100)
x <- rnorm(50, mean = 0)
y <- rnorm(50, mean = 1)
res1 <- pairwise_ks_test(list(X = x, Y = y))
res1
set.seed(100)
x <- rnorm(100, mean = 0)
y <- rnorm(100, mean = 1)
res1 <- pairwise_ks_test(list(X = x, Y = y))
res1
devtools::document()
Rcpp::compileAttributes()
devtools::load_all()
set.seed(100)
x <- rnorm(100, mean = 0)
y <- rnorm(100, mean = 1)
res1 <- pairwise_ks_test(list(X = x, Y = y))
res1
devtools::document()
Rcpp::compileAttributes()
devtools::load_all()
set.seed(100)
x <- rnorm(100, mean = 0)
y <- rnorm(100, mean = 1)
res1 <- pairwise_ks_test(list(X = x, Y = y))
print(res1)
summary)res1
summary(res1)
set.seed(100)
x <- rnorm(100, mean = 0)
y <- rnorm(100, mean = 1)
res1 <- pairwise_ks_test(list(X = x, Y = y))
set.seed(100)
x <- rnorm(100, mean = 0)
y <- rnorm(100, mean = 1)
res1 <- ks_test(list(X = x, Y = y))
summary(res1)
print(res1)
plot(res1)
set.seed(100)
a <- rexp(200)
b <- rexp(80, 0.5)
c <- rexp(150, 1.2)
res2 <- ks_test(list(A = a, B = b, C = c))
res2
print(res2)
#' @export
plot.ks_test <- function(x, show_pairwise_D = FALSE, ...) {
if (!inherits(x, "ks_test")) stop("Object must be of class 'ks_test'")
data_list <- x$data_list
n <- length(data_list)
if (n == 0) stop("No datasets to plot")
if (n > 10) stop("Maximum 10 datasets allowed for plotting")
# Assign colors automatically
colors <- grDevices::rainbow(n)
# Determine overall range for x-axis
all_values <- unlist(data_list)
rng <- range(all_values, finite = TRUE)
# Plot first ECDF
plot(ecdf(data_list[[1]]), col = colors[1], lwd = 2,
xlim = rng, ylim = c(0, 1), xlab = "Value", ylab = "ECDF",
main = "Empirical CDFs of Datasets", ...)
# Add remaining ECDFs
if (n > 1) {
for (i in 2:n) {
lines(ecdf(data_list[[i]]), col = colors[i], lwd = 2)
}
}
# Add legend
legend("bottomright", legend = names(data_list), col = colors, lwd = 2, bty = "n")
# Optional: show pairwise D statistics
if (show_pairwise_D && n > 1) {
pairs <- combn(n, 2)
for (k in 1:ncol(pairs)) {
i <- pairs[1, k]
j <- pairs[2, k]
Fx <- ecdf(data_list[[i]])
Fy <- ecdf(data_list[[j]])
pooled <- sort(unique(c(data_list[[i]], data_list[[j]])))
diffs <- abs(Fx(pooled) - Fy(pooled))
D <- max(diffs)
t_star <- pooled[which.max(diffs)]
# Draw vertical segment at D
segments(t_star, Fx(t_star), t_star, Fy(t_star),
col = "darkgreen", lwd = 2, lty = 2)
# Annotate D value
text(t_star, mean(c(Fx(t_star), Fy(t_star))),
labels = paste0("D=", round(D, 3)),
pos = 3, col = "darkgreen", cex = 0.8)
}
}
}
devtools::document()
Rcpp::compileAttributes()
devtools::load_all()
res2 <- ks_test(list(A = a, B = b, C = c))
plot(res2)
res2
print(res2)
plot(res2)
devtools::document()
Rcpp::compileAttributes()
devtools::load_all()
plot(res2)
set.seed(100)
a <- rexp(200)
b <- rexp(80, 0.5)
c <- rexp(150, 1.2)
res2 <- ks_test(list(A = a, B = b, C = c))
plot(res2)
res2
res2 <- ks_test(list(A = a, B = b, C = c))
devtools::document()
Rcpp::compileAttributes()
plot(res2)
plot(res1)
devtools::document()
devtools::document()
Rcpp::compileAttributes()
devtools::load_all()
set.seed(100)
a <- rexp(200)
b <- rexp(80, 0.5)
c <- rexp(150, 1.2)
res2 <- ks_test(list(A = a, B = b, C = c))
ecdf_plot(res2)
heatmap(res2)
res2
devtools::document()
Rcpp::compileAttributes()
devtools::load_all()
devtools::document()
Rcpp::compileAttributes()
devtools::load_all()
res2 <- ks_test(list(A = a, B = b, C = c))
heatmap_plot.ks_test(res2)
ecdf_plot.ks_test(test2)
ecdf_plot.ks_test(res2)
ecdf_plot.ks_test(res2)
ecdf_plot.ks_test(res2)
devtools::load_all()
devtools::document()
devtools::document()
Rcpp::compileAttributes()
devtools::load_all()
ecdf_plot.ks_test(test2)
ecdf_plot.ks_test(res2)
summary(res2)
print(res2)
plot(res2)
ecdf_plot(res2)
